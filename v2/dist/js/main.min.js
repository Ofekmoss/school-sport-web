function numberFilter(e){if(null==e)return null;var i=e.toString(),n=i.slice(-3);for(i=i.slice(0,-3);0<i.length;)n=i.slice(-3)+","+n,i=i.slice(0,-3);return n}function genderFilter(e){return null!=e?0===e?"בן":"בת":null}function priceFilter(e){if(null==e)return null;var i=e.toString(),n=i.slice(-3);for(i=i.slice(0,-3);0<i.length;)n=i.slice(-3)+","+n,i=i.slice(0,-3);return"₪"+n}function documentNumberFilter(e){if(e){var i=e.toString();if(4<i.length)return parseInt(i.slice(4)).toString()+"-"+i.slice(2,4)+"/"+i.slice(0,2)}return e}function dateFilter(e){return e?(e=new Date(e),isNaN(e)?null:("0"+e.getDate()).slice(-2)+"/"+("0"+(e.getMonth()+1)).slice(-2)+"/"+("000"+e.getFullYear()).slice(-4)):e}function competitionTimeFilter(e){if(e){if("number"==typeof e){if(e<1e11){if(e<1e8){var i=e%100,n=(e=(e-i)/100)%100;return e=(e-n)/100,("0"+i).slice(-2)+"/"+("0"+n).slice(-2)+"/"+("000"+e).slice(-4)}return("0"+(e=new Date(1e3*e)).getDate()).slice(-2)+"/"+("0"+(e.getMonth()+1)).slice(-2)+"/"+("000"+e.getFullYear()).slice(-4)+" "+("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)}e=new Date(e)}else"string"==typeof e&&(e=new Date(e));return isNaN(e)?null:("0"+e.getDate()).slice(-2)+"/"+("0"+(e.getMonth()+1)).slice(-2)+"/"+("000"+e.getFullYear()).slice(-4)}return e}function getTimeText(e){var i=e%60;return("0"+(e-i)/60).slice(-2)+":"+("0"+i).slice(-2)}function activityTextPipe(e){return e?e.map(function(e){return null!=e.day?["א'","ב'","ג'","ד'","ה'","ו'","ש'"][e.day]+(null!=e.startTime?" "+getTimeText(e.startTime):"")+(null!=e.endTime?"-"+getTimeText(e.endTime):""):""}).join("; "):""}function dateTimeFilter(e){return e?(e=new Date(e),isNaN(e)?null:("0"+e.getDate()).slice(-2)+"/"+("0"+(e.getMonth()+1)).slice(-2)+"/"+("000"+e.getFullYear()).slice(-4)+" "+("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)):e}function customDateFilter(e,i){if("string"==typeof e&&0<e.indexOf("T")){void 0!==i&&null!=i&&0!==i.length||(i="dd/MM/yyyy HH:mm:ss");var n=e.split("T"),t=n[0].split("-"),a=n[1].split(":");if(3===t.length&&3===a.length){var r=t[0],s=t[1],l=t[2],u=a[0],m=a[1],c=a[2].split(".")[0],o=i+"";return o=o.replace("dd",l).replace("MM",s).replace("yyyy",r).replace("HH",u).replace("mm",m).replace("ss",c)}}return dateTimeFilter(e)}function idNumberFilter(e){return e?("00000000"+e).slice(-9):e}Vue.use(VueResource),Vue.filter("number",numberFilter),Vue.filter("gender",genderFilter),Vue.filter("price",priceFilter),Vue.filter("documentNumber",documentNumberFilter),Vue.filter("date",dateFilter),Vue.filter("competitionTime",competitionTimeFilter),Vue.filter("activityTextPipe",activityTextPipe),Vue.filter("dateTime",dateTimeFilter),Vue.filter("customDate",customDateFilter),Vue.filter("idNumber",idNumberFilter),require.config({baseUrl:"js"});var menuItems=[{link:"registration/select",image:"img/document-edit.svg",imageActive:"img/document-edit-active.svg",name:"הרשמה",user:["school","city"]},{link:"supervisor/teams-approval",image:"img/document-edit.svg",imageActive:"img/document-edit-active.svg",name:"הרשמה",user:["supervisor"]},{link:"finance/team-payments-approval",image:"img/document-edit.svg",imageActive:"img/document-edit-active.svg",name:"אישורים",user:["finance"]},{link:"manage/dashboard",image:"img/dashboard.svg",imageActive:"img/dashboard.svg",name:"לוח בקרה",user:["admin"]},{link:"manage/teams",image:"img/icon-teams.svg",imageActive:"img/icon-teams-active.svg",name:"קבוצות",user:["admin"]},{link:"admin/players",image:"img/icon-players.svg",imageActive:"img/icon-players-active.svg",name:"שחקנים",user:["admin"]},{link:"admin/schools",image:"img/icon-schools.svg",imageActive:"img/icon-schools-active.svg",name:"בתי-ספר",user:["admin"]},{link:"admin/categories",image:"img/icon-championships.svg",imageActive:"img/icon-championships-active.svg",name:"תחרויות",user:["admin"]},{link:"admin/project",image:"img/icon-badge.svg",imageActive:"img/‏‏icon-badge-active.svg",name:"תכניות",user:["admin"]},{link:"admin/transfer-requests",image:"img/user.svg",imageActive:"img/user-active.svg",name:"אישורי העברות",user:["admin"]},{link:"admin/cities",name:"רשויות",image:"img/cities.svg",user:["admin"]},{link:"finance/accounts",name:"כספים - חשבונות",image:"img/finance.svg",user:["admin"]},{link:"finance/receipts",name:"כספים - קבלות",image:"img/finance.svg",user:["admin"]},{link:"finance/charges",name:"כספים - חיובים",image:"img/finance.svg",user:["admin"]},{link:"admin/general-settings",name:"הגדרות כלליות",image:"img/settings.svg",user:["admin"]}];define("chart.js",[],function(){return Chart}),require(["templates/default","views","dialog","services/access","imports/vuejs-datepicker","imports/he","imports/vue-chartjs"],function(e,u,i,n,t,a,r){function m(n){n.menu.splice(0,n.menu.length),menuItems.forEach(function(e){for(var i=0;i<e.user.length;i++)if(n.user&&n.user.roles&&-1!==n.user.roles.indexOf(e.user[i])){e.selected=!1,n.menu.push(e);break}}),n.menu[n.activeMenuItem]&&(n.menu[n.activeMenuItem].selected=!0)}Vue.prototype.Hebrew=a,Vue.component("datepicker",t),Vue.component("charts",r);var s=Vue.extend({template:e.main,data:function(){return{user:null,menu:[],showMenu:!1,admin:!1,loggedIn:null,viewManager:u,activeMenuItem:0}},mounted:function(){var l=this;n.get(function(e,i){if(e)l.loggedIn=!1,"login"!==u.name&&u.openView("login");else{var n=i.roles&&0<=i.roles.indexOf("admin");l.showMenu=!n,l.admin=n,l.user=i,l.loggedIn=!0,m(l);var t=location.hash;if("#"===t[0]&&(t=t.slice(1)),"/"===t[0]&&(t=t.slice(1)),0<t.length&&"login"!==t)u.openView(t);else if(l.user.defaultRoute&&!u.selected){for(var a=!1,r=0;r<u.views.length;r++){var s=u.views[r];if(s.def&&s.def.route===l.user.defaultRoute){a=!0;break}}a||u.openView(l.user.defaultRoute)}}}),n.$on("login",function(e){var i=e.roles&&0<=e.roles.indexOf("admin");l.loggedIn=!0,l.showMenu=!i,l.admin=i,l.user=e,u.reset(),m(l),l.user.defaultRoute&&u.openView(l.user.defaultRoute)}),n.$on("logout",function(){l.loggedIn=!1,l.showMenu=!1,l.admin=!1,l.user=null,u.reset(),m(l),u.openView("login")})},methods:{handleLogin:function(e){console.log(e)},handleAlterViewChange:function(e,i){u.openView(e.target.value)},open:function(e,i){this.activeMenuItem=i,m(this),u.openView(e.link)},logout:function(){n.logout()},openNewTabDialog:function(){i.open("manage/new-tab-dialog",{types:this.menu.map(function(e){return{title:e.name,image:e.image,type:e.link}})},function(e,i){void 0!==i&&u.openView(i.type)})},selectView:function(e){u.selectView(e)},selectTab:function(e){e.last&&this.selectView(e.last)},closeView:function(e,i){e.stopPropagation(),u.closeView(i)}}});Vue.component("main-view",s),new Vue({template:"<main-view></main-view>",el:"#main"})});
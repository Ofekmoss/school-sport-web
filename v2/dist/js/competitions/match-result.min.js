define(["templates/competitions","services/competitions","utils"],function(t,s,e){return Vue.extend({template:t["match-result"],data:function(){return{gameStructure:null,teamA:null,teamB:null,scoreA:null,scoreB:null,sets:null,setList:null,setsPartial:!1,scoreMismatch:!1,games:!1,outcome:null}},mounted:function(){if(this.gameStructure&&0<this.gameStructure.sets){if(this.setList=[],this.sets)for(;this.setList.length<this.gameStructure.sets&&this.setList.length<this.sets.length;){var t=this.sets[this.setList.length];this.setList.push({a:t.a.toString(),b:t.b.toString()})}for(;this.setList.length<this.gameStructure.sets;)this.setList.push({a:null,b:null});1<this.gameStructure.games&&(this.games=!0),this.updateSets(!1)}},computed:{setsSet:function(){var t=0;if(this.setList)for(var s=0;s<this.setList.length;s++){var e=this.setList[s];if(!e.a||!e.b||""===e.a.trim()||""===e.b.trim())break;t++}return t}},methods:{setOutcome:function(t){this.outcome=t},clearResult:function(){if(this.outcome=null,this.scoreA=null,(this.scoreB=null)!=this.setList){for(var t=0;t<this.setList.length;t++){var s=this.setList[t];s.a=null,s.b=null}this.updateSets(!1)}},focusInput:function(t){t.target.select()},updateSets:function(t){if(null!=this.setList){var s=0,e=0;this.sets=[],this.setsPartial=!1;for(var i=0;i<this.setList.length;i++){var l=this.setList[i],n={a:null,b:null};l.a&&0<l.a.trim().length&&(n.a=parseInt(l.a),isNaN(n.a)&&(n.a=null)),l.b&&0<l.b.trim().length&&(n.b=parseInt(l.b),isNaN(n.b)&&(n.b=null));var r=(n.a||0)-(n.b||0);if(r<0?e++:0<r&&s++,null==n.a||null==n.b){this.setsPartial=null!=n.a||null!=n.b;break}this.sets.push(n)}t?(this.scoreA=s,this.scoreB=e,this.scoreMismatch=!1):this.scoreMismatch=0<this.sets.length&&(s!=parseInt(this.scoreA)||e!=parseInt(this.scoreB))}else this.sets=null},cancel:function(){this.$emit("close")},confirm:function(){if(!this.scoreMismatch&&!this.setsPartial){var t={};3==this.outcome||4==this.outcome?t.outcome=this.outcome:(t={result:{scoreA:parseInt(this.scoreA),scoreB:parseInt(this.scoreB)}},this.sets&&(t.result.sets=this.sets)),this.$emit("close",t)}}}})});
define(["templates/admin","utils","dialog","services/access","components/multiselect","generic/data-table"],function(t,e,s,n){function a(t,e){for(var s=0;s<t.length;s++){var n=t[s];if(n.id===e)return n}return null}function o(n){!function(s,n){Vue.http.get("/api/v2/admin/competitions?clubs=1").then(function(t){for(var e=0;e<t.body.sports.length;e++)s.sports.push(t.body.sports[e]);n()},function(t){n(t)})}(n,function(t){t||Vue.http.get("/api/v2/admin/teams?clubs=1").then(function(t){for(var e=0;e<t.body.length;e++){var s=t.body[e];s.sport=a(n.sports,s.sport),s.sport&&(s.category=a(s.sport.categories,s.competition)),s.category&&n.teams.push(s)}},function(t){console.log(t)})})}return Vue.extend({template:t["club-teams-approval"],data:function(){return{teams:[],columns:[{key:"school.name",name:"בית ספר",active:!0},{key:"sport.name",name:"ענף ספורט",active:!0},{key:"category.name",name:"קטגוריה",active:!0},{name:"סטטוס",key:"status.coordinator",active:!0,lookup:{0:"ממתין לאישור","-1":"לא אושר",1:"אושר"}}],sports:[],searchText:"",isSelectAll:!1,statuses:[{id:1,name:"אושר"},{id:2,name:"לא אושר"},{id:3,name:"ממתין לאישור"}],selectedStatus:null,selectedTeams:[]}},mounted:function(){o(this)},methods:{handleSelectionChange:function(){this.selectedTeams.splice(0,this.selectedTeams.length),this.selectedStatus=null;for(var t=0;t<this.teams.length;t++){var e=this.teams[t];e.selected&&(0===this.selectedTeams.length?this.selectedStatus=e.status.coordinator:this.selectedStatus!=e.status.coordinator&&(this.selectedStatus=null),this.selectedTeams.push(e))}},changeStatus:function(e){var s=this;Vue.http.post("/api/v2/admin/teams/status/coordinator",{teams:s.selectedTeams.map(function(t){return t.id}),status:e}).then(function(){s.selectedStatus=e;for(var t=0;t<s.selectedTeams.length;t++)s.selectedTeams[t].status.coordinator=e},function(t){console.log(t)})},logout:function(){n.logout()}}})});
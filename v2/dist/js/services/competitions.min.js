define([],function(){var e="אבגדהוזחט",n="יכלמנסעפצ",o=["א'","ב'","ג'","ד'","ה'","ו'","ז'","ח'","ט'","י'",'י"א','י"ב'];function r(t,e,n){for(var o=0;o<t.length;o++){var i=t[o],s=e[i];void 0!==s&&(n[i]=s)}}function u(t,e,n,o){var i=e[t];if(i){var s=i.$reset?null:n[t];for(var p in s||(n[t]=s={}),i)if("$reset"!==p){var r=s[p];r||(s[p]=r=new o(n,p)),r.$update(i[p])}}}function a(t,e){for(var n=0;n<t.length;n++){if(t[n].id==e)return n}return-1}function h(t,e){for(var n=0;n<t.length;n++){var o=t[n];if(o.id===e)return o}return null}function i(t,e){for(var n=0;n<t.length;n++){var o=t[n];if(o.index===e)return o}return null}function s(t,e,n,o,i){i||(i=h);var s=e[t];if(s){var p=s.$reset?null:n[t];for(var r in p||(n[t]=p=[]),s)if("$reset"!==r){var u=i(p,r);u||(u=new o(n,r),p.push(u)),u.$update(s[r])}}else n[t]||(n[t]=[])}function p(t,e){this.group=t,this.index=e}function c(t,e){this.id=e,this.group=t}function m(t,e){this.group=t,this.index=e,this.number=parseInt(e)}function f(t,e){this.id=e,(this.phase=t).event.competition.groups[e]=this}function d(t,e){this.phase=t,this.index=e}function l(t,e){this.id=e,(this.event=t).competition.phases[e]=this}function v(t,e){this.competition=t,this.id=e}function g(t,e){this.competition=t,this.id=e}function y(t,e){this.competition=t,this.id=e}function b(t){this.id=t,this.phases={},this.groups={}}p.prototype.getTeam=function(){var t=this.group.phase.event.competition;if(this.team)return t.teams[this.team];if(!this.reference)return{name:"קבוצה "+(parseInt(this.index)+1),group:e};if(null!=this.reference.group){var e=this.group.phase.event.competition.groups[this.reference.group];if(e)return{name:e.formatName()+" - מיקום "+(this.reference.position+1),group:e,position:this.reference.position}}return null},p.prototype.remove=function(n){var t=this.group,e="/groups/"+encodeURIComponent(t.id)+"/teams/"+encodeURIComponent(this.index);t.phase.event.competition.delete(e,function(t,e){n&&(t?n(t):n())})},p.prototype.update=function(t,n){var e=this.group,o="/groups/"+encodeURIComponent(e.id)+"/teams/"+encodeURIComponent(this.index);e.phase.event.competition.put(o,t,function(t,e){t?n(t):n(null,e)})},p.prototype.$update=function(t){r(["teamReference","team","position","setPosition","games","losses","points","pointsAgainst","reference","score","sets","setsAgainst","smallPoints","smallPointsAgainst","team","technicalLosses","technicalWins","ties","wins"],t,this)},c.prototype.$update=function(t){r(["number","sequence","opponentA","opponentB","matchReferenceA","matchReferenceB","venue","time","functionaries","scoreA","scoreB","smallPointsA","smallPointsB","outcome","result"],t,this)},c.prototype.update=function(t,n){var e="/matches/"+encodeURIComponent(this.id);this.group.phase.event.competition.put(e,t,function(t,e){t?n(t):n(null,e)})},c.prototype.delete=function(n){var t="/matches/"+encodeURIComponent(this.id);this.group.phase.event.competition.delete(t,function(t,e){t?n(t):n(null,e)})},m.prototype.$update=function(t){r(["id","participant","score","points","position"],t,this)},m.prototype.getParticipant=function(){return this.participant?"N"===this.participant[0]?{number:this.participant.slice(1),getTeam:function(){return null}}:this.group.phase.event.competition.participants[this.participant]:null},f.prototype.$update=function(t){r(["name","number","state","gameBoard","rounds"],t,this),s("teams",t,this,p,i),s("matches",t,this,c),s("entrants",t,this,m,i),this.matches&&this.matches.sort(function(t,e){return t.number-e.number})},f.prototype.formatName=function(){var t=this.name.indexOf("%%");if(0<=t){var e=this.phase.groups.indexOf(this)+1;return this.name.slice(0,t)+R.hebNumber(e)+this.name.slice(t+2)}return this.name},f.prototype.assignTeam=function(t,n){var o=this,e="/groups/"+encodeURIComponent(this.id)+"/teams";this.phase.event.competition.post(e,t,function(t,e){n&&(t?n(t):n(null,o.teams[e]))})},f.prototype.updateRounds=function(t,n){var e="/groups/"+encodeURIComponent(this.id)+"/rounds";this.phase.event.competition.post(e,t,function(t,e){n&&(t?n(t):n())})},f.prototype.insertMatch=function(t,n){var e="/groups/"+encodeURIComponent(this.id)+"/matches";this.phase.event.competition.post(e,t,function(t,e){n&&(t?n(t):n(null,e))})},f.prototype.buildFromBoard=function(t,n){var e="/groups/"+encodeURIComponent(this.id)+"/matches/build";this.phase.event.competition.post(e,{board:t},function(t,e){n&&(t?n(t):n(null,e))})},f.prototype.update=function(t,n){var e="/groups/"+encodeURIComponent(this.id);this.phase.event.competition.put(e,t,function(t,e){t?n(t):n(null,e)})},f.prototype.delete=function(t,n){var e="/groups/"+encodeURIComponent(this.id);t&&(e+="?withData=1"),this.phase.event.competition.delete(e,function(t,e){t?n(t):n(null,e)})},d.prototype.$update=function(t){r(["name","format","count"],t,this)},l.prototype.$update=function(t){r(["name","number","meeting"],t,this),s("groups",t,this,f),this.groups&&this.groups.sort(function(t,e){return t.number-e.number}),s("levels",t,this,d,i)},l.prototype.update=function(t,n){this.event.competition.put("/phases/"+this.id,t,function(t,e){t?n(t):n(null,e)})},l.prototype.delete=function(t,n){var e="/phases/"+encodeURIComponent(this.id);t&&(e+="?withData=1"),this.event.competition.delete(e,function(t,e){t?n(t):n(null,e)})},l.prototype.getTeamGroup=function(t){if(this.groups)for(var e=0;e<this.groups.length;e++)for(var n=this.groups[e],o=0;o<n.teams.length;o++){if(n.teams[o].team==t)return n}return null},l.prototype.insertGroup=function(t,e,n){var o=this;this.event.competition.post("/phases/"+encodeURIComponent(this.id)+"/groups",{name:t,number:e},function(t,e){t?n(t):n(null,o.getGroup(e))})},l.prototype.getGroup=function(t){return h(this.groups,t.toString())},v.prototype.$update=function(t){r(["name","phase"],t,this),s("phases",t,this,l),this.phases.sort(function(t,e){return t.number-e.number})},v.prototype.getPhase=function(t){return h(this.phases,t.toString())},v.prototype.insertPhase=function(t,e,n){var o=this;this.competition.post("/events/"+encodeURIComponent(this.id)+"/phases",{name:t,number:e},function(t,e){t?n(t):n(null,o.getPhase(e))})},v.prototype.currentPhase=function(){return 0<=this.phase&&this.phase<this.phases.length&&this.phases[this.phase]},v.prototype.nextPhase=function(n){this.competition.put("/events/"+encodeURIComponent(this.id)+"/phase",{next:!0},function(t,e){t?n(t):n()})},v.prototype.previousPhase=function(t,n){this.competition.put("/events/"+encodeURIComponent(this.id)+"/phase",{previous:!0,clearMatches:t},function(t,e){t?n(t):n()})},g.prototype.$update=function(t){r(["identifier","name"],t,this)},y.prototype.$update=function(t){r(["identifier","name","team","number"],t,this)},y.prototype.getTeam=function(){return this.competition.teams[this.team]},b.prototype.updateMatches=function(t,n){this.post("/matches",t,function(t,e){t?n(t):n(null,e)})},b.prototype.post=function(t,e,n){var o=this;Vue.http.post("/api/v2/competitions/"+encodeURIComponent(this.id)+t+"?ver="+encodeURIComponent(this.$version),e).then(function(t){o.$update(t.body),n(null,t.body.$result)},function(t){n(t)})},b.prototype.put=function(t,e,n){var o=this;Vue.http.put("/api/v2/competitions/"+encodeURIComponent(this.id)+t+"?ver="+encodeURIComponent(this.$version),e).then(function(t){o.$update(t.body),n(null,t.body.$result)},function(t){n(t)})},b.prototype.delete=function(t,e){var n=this,o="/api/v2/competitions/"+encodeURIComponent(this.id)+t;o+=0<o.indexOf("?")?"&":"?",o+="ver="+encodeURIComponent(this.$version),Vue.http.delete(o).then(function(t){n.$update(t.body),e(null,t.body.$result)},function(t){e(t)})},b.prototype.$update=function(t){if(t.$removed)for(var e=0;e<t.$removed.length;e++){var n=t.$removed[e];if(null!=n.phase&&this.events){var o=this.events[n.event];if(o){var i=a(o.phases,n.phase);if(0<=i)if(null!=n.group){var s=o.phases[i];if(0<=(i=a(s.groups,n.group)))if(null!=n.match){var p=s.groups[i];0<=(i=a(p.matches,n.match))&&p.matches.splice(i,1)}else delete this.groups[n.group],s.groups.splice(i,1)}else delete this.phases[n.phase],o.phases.splice(i,1)}}}r(["$version","name","category","sport","season","ruleset","rules"],t,this),u("events",t,this,v),u("teams",t,this,g),u("participants",t,this,y)};var R={open:function(n,o){Vue.http.get("/api/v2/competitions/"+encodeURIComponent(n)).then(function(t){var e=new b(n);e.$update(t.body),o(null,e)},function(t){o(t)})},season:function(t,e){Vue.http.get("/api/v2/competitions/seasons/"+encodeURIComponent(t)).then(function(t){e(null,t.body)},function(t){e(t)})},ruleset:function(t,e){Vue.http.get("/api/v2/competitions/rulesets/"+encodeURIComponent(t)).then(function(t){e(null,t.body)},function(t){e(t)})},disciplines:function(t,e){void 0===e?(e=t,Vue.http.get("/api/v2/competitions/disciplines").then(function(t){e(null,t.body)},function(t){e(t)})):Vue.http.get("/api/v2/competitions/sports/"+encodeURIComponent(t)+"/disciplines").then(function(t){e(null,t.body)},function(t){e(t)})},time:function(t,e,n){return null!=e?1e4*t+100*e+n:null!=t?("number"!=typeof t&&"string"!=typeof t||(t=new Date(t)),Math.floor(t.getTime()/1e3)):null},hebNumber:function(t){return!t||t<0||99<t?t:15===t?'ט"ו':16===t?'ט"ז':t<10?e[t-1]+"'":t%10==0?n[t/10-1]+"'":n[Math.floor(t/10)]+'"'+e[t%10-1]},getCategoryName:function(t){var e=o[t.minAge]||t.minAge;return t.minAge!==t.maxAge&&(e+="-"+(o[t.maxAge]||t.maxAge)),1==t.gender?e+=" תלמידים":2==t.gender?e+=" תלמידות":e+=" תלמידים/ות",e},Outcome:{Tie:0,WinA:1,WinB:2,TechnicalA:3,TechnicalB:4}};return R});
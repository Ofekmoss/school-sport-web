define(["templates/registration","dialog"],function(i,e){return Vue.extend({template:i["pele-details"],data:function(){return{name:"",managerName:"",symbol:"",address:"",socioEconomicRank:"",geographicIndex:"",totalPopulation:"",ethiopianPopulation:"",childrenPopulation:"",ethiopianChildrenPopulation:"",manager:{},supervisor:{},isFormValid:!1,confirmation:!1,confirmedAt:null}},computed:{},mounted:function(){var o=this;Vue.http.get("/api/v2/registration/project/3").then(function(i){if((i=i.body).id){var t=i.item1?JSON.parse(i.item1):{};o.name=i.city.name,o.managerName=i.city.managerName,o.symbol=i.city.symbol,o.address=i.city.address,o.socioEconomicRank=i.city.socioEconomicRank,o.geographicIndex=i.city.geographicIndex,o.totalPopulation=t.tp,o.ethiopianPopulation=t.ep,o.childrenPopulation=t.cp,o.ethiopianChildrenPopulation=t.ecp,o.manager=i.manager,o.supervisor=i.supervisor,setTimeout(function(){o.checkValidity()}),Vue.http.get("/api/v2/registration/school-confirmations").then(function(i){for(var t=0;t<i.body.length;t++){var n=i.body[t];if("pele-details"===n.Form){o.confirmation=!0,o.confirmedAt=n.DateConfirmed;break}}o.confirmedAt||e.open("registration/project/pele-greetings-dialog",{},function(i,t){})},function(i){console.log(i),e.open("registration/project/pele-greetings-dialog",{},function(i,t){})})}})},methods:{next:function(){var t=this,i={tp:this.totalPopulation,ep:this.ethiopianPopulation,ecp:this.ethiopianChildrenPopulation,cp:this.childrenPopulation};(function(i){return Vue.http.put("/api/v2/registration/project/3",i)})({city:{managerName:this.managerName,symbol:this.symbol,address:this.address,socioEconomicRank:this.socioEconomicRank,geographicIndex:this.geographicIndex},item1:JSON.stringify(i),manager:this.manager,supervisor:this.supervisor}).then(function(){if(t.$emit("next"),!t.confirmedAt){Vue.http.post("/api/v2/registration/confirmation",{Form:"pele-details"}).then(function(i){t.confirmedAt=new Date},function(i){console.log(i)})}})},checkValidity:function(){this.isFormValid=0==document.querySelectorAll("#form :invalid").length&&this.confirmation}},watch:{name:function(){this.checkValidity()},managerName:function(){this.checkValidity()},symbol:function(){this.checkValidity()},address:function(){this.checkValidity()},socioEconomicRank:function(){this.checkValidity()},geographicIndex:function(){this.checkValidity()},totalPopulation:function(){this.checkValidity()},ethiopianPopulation:function(){this.checkValidity()},childrenPopulation:function(){this.checkValidity()},ethiopianChildrenPopulation:function(){this.checkValidity()},manager:function(){this.checkValidity()},supervisor:function(){this.checkValidity()},confirmation:function(){this.checkValidity()}}})});
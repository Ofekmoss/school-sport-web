define(["templates/registration","dialog"],function(e,i){function t(e){return 3==e.type||void 0!==e.certification}return Vue.extend({template:e["project-team-dialog"],data:function(){return{formValidated:!1,team:null,newTeam:!1,part1:{},part2:{},part3:{},gradeIndex:null,gradeClass:null,gradeClassType:null,studentCount:null,certifications:[{value:1,name:"מאמן"},{value:2,name:"מדריך"},{value:3,name:"מורה"}],grades:[{value:5,name:"ה'"},{value:6,name:"ו'"}],gradeClassesTypes:[{value:0,name:"כיתה רגילה"},{value:1,name:"חינוך מיוחד"},{value:2,name:"כיתה קטנה"}],gradeClasses:[{value:0,name:"1'"},{value:1,name:"2'"},{value:2,name:"3'"},{value:3,name:"4'"},{value:4,name:"5'"},{value:5,name:"6'"},{value:6,name:"7'"},{value:7,name:"8'"},{value:8,name:"9'"},{value:9,name:"10'"}],school:"",teams:[],items:[]}},watch:{part1:{handler:function(){this.validateForm()},deep:!0},part2:{handler:function(){this.validateForm()},deep:!0},part3:{handler:function(){this.validateForm()},deep:!0},studentCount:function(){},gradeIndex:function(){this.validateForm()},gradeClass:function(){this.validateForm()},gradeClassType:function(){this.validateForm()}},mounted:function(){var e=this;if(null==e.team)e.newTeam=!0;else{this.part1=this.team.part1,this.part2=this.team.part2,this.part3=this.team.part3;var t=this.team.ages+"";this.gradeIndex=t[1],this.gradeClass=t[2],this.gradeClassType=t[3],this.studentCount=this.team.studentCount,this.id=this.team.id,setTimeout(function(){e.validateForm()})}},methods:{cancel:function(){this.$emit("close")},confirm:function(){var t=this,e=function(e,t,a){var i="1";return i+=e,i+=t,i+=a}(this.gradeIndex,this.gradeClass,this.gradeClassType),a={item1:JSON.stringify(this.part1),item2:JSON.stringify(this.part2),item3:JSON.stringify(this.part3),ages:e,gradeIndex:this.gradeIndex,gradeClass:this.gradeClass,gradeClassType:this.gradeClassType,studentCount:this.studentCount,school:this.school,id:this.id};Vue.http.put("/api/v2/registration/project/1/teams",{team:a}).then(function(e){t.newTeam&&(a.id=e.body.id),t.$emit("close",a)}).catch(function(e){i.open("general/error-message",{caption:"פעולה נכשלה",message:"string"==typeof e.body?e.body:"שגיאה בשמירת כיתה"})})},validateForm:function(){var e=document.querySelectorAll("#validated-form :invalid");this.formValidated=0==e.length&&t(this.part1)&&t(this.part2)&&t(this.part3)},typeChanged:function(e,t){3==e.target.value&&(this["part"+t].certification=void 0,this["part"+t]=Object.assign({},this["part"+t]))}}})});
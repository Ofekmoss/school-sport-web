define(["templates/manage","manage/dal","utils","dialog","manage/filters-players","manage/data-table2","components/multiselect"],function(e,a,t,n){var i=1,r=2,o=[{key:"Student.FirstName",name:"שם פרטי",active:!0,type:"text",filter:!0},{key:"Student.LastName",name:"שם משפחה",active:!0,type:"text",filter:!0},{key:"Student.IdNumber",name:"תעודת זהות",active:!0,type:"text",filter:!0},{key:"BirthDate",name:"תאריך לידה",active:!0,type:"text"},{key:"Student.Grade",name:"כיתה",active:!0,type:"text",filter:!0},{key:"Student.TeamName",name:"שם קבוצה",active:!0,type:"text",filter:!0},{key:"Student.TeamNumber",name:"קבוצה",active:!0,type:"text",filter:!0},{key:"Student.City.Name",name:"רשות",active:!1,type:"text",filter:!0},{key:"Player.RegistrationDate",name:"תאריך רישום",active:!1,type:"text"},{key:"Player.ShirtNumber",name:"מספר חולצה",active:!1,type:"text",filter:!0},{key:"Championship.Name",name:"אליפות",active:!1,type:"text",filter:!0},{key:"Sport.Name",name:"ענף ספורט",active:!1,type:"text",filter:!0},{key:"Category.Name",name:"קטגוריה",active:!1,type:"text",filter:!0,openTab:{route:"manage/teams",params:{region:"Region.Id",sport:"Sport.Id",championship:"Championship.Id",category:"Category.Category"}}},{key:"Status",name:"סטטוס",active:!0,type:"text",filter:!0},{key:"Student.Gender",name:"מין",active:!0,type:"text",filter:!0},{key:"Student.School.Name",name:"בית ספר",active:!0,type:"text",filter:!0},{key:"Student.School.Symbol",name:"סמל בית ספר",active:!1,type:"text",filter:!0},{key:"Student.Region.Name",name:"מחוז",active:!1,type:"text",filter:!0}];return Vue.extend({template:e.players,data:function(){return{tabName:"שחקנים",team:0,caption:"שחקנים",image:"img/icon-players.svg",records:[],columns:o,selectedRecord:[],initFilters:{}}},props:{sport:{},region:{},championship:{},category:{},team:{}},mounted:function(){this.sport=this.sport?parseInt(this.sport):"",this.region=this.region?parseInt(this.region):"",this.championship=this.championship?parseInt(this.championship):"",this.category=this.category?parseInt(this.category):"",this.team=this.team?parseInt(this.team):"",this.initFilters={sport:this.sport,region:this.region,championship:this.championship,category:this.category,team:this.team}},methods:{updateCaption:function(e){this.caption=e},saveRecord:function(){console.log("saving... ",this.selectedRecord)},refresh:function(e){if(e&&(this.updateCaption(e.description),this.championship=e.championship&&-1!=e.championship.id?e.championship.id:"",this.category=e.category&&-1!=e.category.id?e.category.id:"",this.region=e.region&&-1!=e.region.id?e.region.id:"",this.sport=e.sport&&-1!=e.sport.id?e.sport.id:"",this.team=e.team&&-1!=e.team.id?e.team.id:""),!e||e.team){var t={championship:this.championship,region:this.region,sport:this.sport,category:this.category,team:this.team},i=this;a.getPlayers(t).then(function(e){i.records=e})}else this.records.splice()},onPlayerCards:function(){var e="/api/v2/registration/teams/"+this.team+"/player-cards";window.open(e,"_blank")},onMoreInfo:function(e){this.onRecordSelect(e),n.open("manage/new-player2",{record:this.selectedRecord,state:i,disableClickOutside:!0})},onRecordSelect:function(e){this.selectedRecord=e},newPlayer:function(){n.open("manage/new-player2",{record:{Player:{},Student:{School:{},Region:{}}},state:r,disableClickOutside:!0})},removePlayer:function(){var i=this;n.open("general/message-box",{caption:"מחיקת שחקן",message:"האם למחוק את השחקן?",alert:!0,confirmText:"כן",cancelText:"לא"},function(e,t){t&&a.deletePlayer(i.selectedRecord[0].Player.Id).then(function(e,t){t||i.updateRemovedPlayer(i.selectedRecord[0])})})},approvePlayers:function(){},updateRemovedPlayer:function(t){this.records.length<=0||(this.records=this.records.filter(function(e){return e.Player.Id!=t.Player.Id}))},onActiveColumns:function(){var i=this,e=i.columns.map(function(e){return Object.assign({},e)});n.open("manage/columns-select-dialog",{columns:e,max:15},function(e,t){t&&(i.columns=t.map(function(e){return Object.assign({},e)}))})}}})});
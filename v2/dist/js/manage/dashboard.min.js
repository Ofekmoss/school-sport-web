define(["templates/manage","manage/dal","utils","consts","dialog","services/access","components/doughnut-chart","components/bar-chart"],function(t,i,n,a,o,s){function e(t,a){null!=a.TeamsByGender&&(t.teamsData.datasets[0].data[0]=a.TeamsByGender.Boys,t.teamsData.datasets[0].data[1]=a.TeamsByGender.Girls,t.teamsData.datasets[0].data[2]=a.TeamsByGender.Unknown,t.teamsData.datasets[0].data=t.teamsData.datasets[0].data.slice(),t.teamsData=Object.assign({},t.teamsData)),null!=a.PlayersByGender&&(t.playersData.datasets[0].data[0]=a.PlayersByGender.Boys,t.playersData.datasets[0].data[1]=a.PlayersByGender.Girls,t.playersData.datasets[0].data[2]=a.PlayersByGender.Unknown,t.playersData.datasets[0].data=t.playersData.datasets[0].data.slice(),t.playersData=Object.assign({},t.playersData)),null!=a.Pele&&(t.peleData.datasets[0].data[0]=a.Pele.PlayersByGender.Boys,t.peleData.datasets[0].data[1]=a.Pele.PlayersByGender.Girls,t.peleData.datasets[0].data[2]=a.Pele.PlayersByGender.Unknown,t.peleData.datasets[0].data=t.peleData.datasets[0].data.slice(),t.peleData=Object.assign({},t.peleData),t.pelePercent=a.Pele.Percentage.toFixed(2))}return Vue.extend({template:t.dashboard,data:function(){return{tabName:"לוח בקרה",permanent:!0,dataLoading:!1,caption:"לוח בקרה",image:"img/dashboard.svg",sports:[],sport:null,originalSports:[],categories:[],category:null,regions:[],region:null,originalRegion:null,seasons:[],season:null,championships:[],type:null,loggedUser:null,dashboardLatestData:null,lastSportTotalFilter:null,footerData:{},contentSiteUrl:"",calendarDayCaption:"",types:a.sportTypes,championship:null,date:new Date,allEvents:[],events:[],totals:{},pelePercent:0,paymentsData:{plain:!0,labels:["תשלומים"],datasets:[{label:"שולם",backgroundColor:["#2ECC40"],data:[]},{label:"לא שולם",backgroundColor:["#FF4136"],data:[]}]},teamsData:{labels:["ספורטאים","ספורטאיות","מעורבות"],datasets:[{label:"קבוצות",backgroundColor:["#0074D9","#FF4136","#2ECC40","#FF851B","#7FDBFF","#B10DC9","#FFDC00","#001f3f","#39CCCC","#01FF70","#85144b","#F012BE","#3D9970","#111111","#AAAAAA"],data:[]}]},playersData:{legendBoxWidth:35,labels:["ספורטאים"," ספורטאיות","מגדר לא ידוע"],datasets:[{label:"שחקנים",backgroundColor:["#0074D9","#FF4136","#2ECC40","#FF851B","#7FDBFF","#B10DC9","#FFDC00","#001f3f","#39CCCC","#01FF70","#85144b","#F012BE","#3D9970","#111111","#AAAAAA"],data:[]}]},peleData:{labels:["ספורטאים"," ספורטאיות","מגדר לא ידוע"],datasets:[{label:"שחקנים",backgroundColor:["#0074D9","#FF4136","#2ECC40","#FF851B","#7FDBFF","#B10DC9","#FFDC00","#001f3f","#39CCCC","#01FF70","#85144b","#F012BE","#3D9970","#111111","#AAAAAA"],data:[]}]},sportsTotals:{labels:[],datasets:[{label:"מאושרות",backgroundColor:["#0074D9","#FF4136","#2ECC40","#FF851B","#7FDBFF","#B10DC9","#FFDC00","#001f3f","#39CCCC","#01FF70","#85144b","#F012BE","#3D9970","#111111","#AAAAAA","#0074D9","#FF4136","#2ECC40","#FF851B","#7FDBFF","#B10DC9","#FFDC00","#001f3f","#39CCCC","#01FF70","#85144b","#F012BE","#3D9970","#111111","#AAAAAA","#0074D9","#FF4136","#2ECC40","#FF851B","#7FDBFF","#B10DC9","#FFDC00","#001f3f","#39CCCC","#01FF70","#85144b","#F012BE","#3D9970","#111111","#AAAAAA"],data:[]},{label:"רשומות",backgroundColor:["#0074D9","#FF4136","#2ECC40","#FF851B","#7FDBFF","#B10DC9","#FFDC00","#001f3f","#39CCCC","#01FF70","#85144b","#F012BE","#3D9970","#111111","#AAAAAA","#0074D9","#FF4136","#2ECC40","#FF851B","#7FDBFF","#B10DC9","#FFDC00","#001f3f","#39CCCC","#01FF70","#85144b","#F012BE","#3D9970","#111111","#AAAAAA","#0074D9","#FF4136","#2ECC40","#FF851B","#7FDBFF","#B10DC9","#FFDC00","#001f3f","#39CCCC","#01FF70","#85144b","#F012BE","#3D9970","#111111","#AAAAAA"],data:[]}],singleSportDataSet:{label:"ניסוי",backgroundColor:["#0074D9"],data:[0]}},totalDataColumns:{Data:[{Type:null,Columns:[{Items:[{default:!0,caption:"קבוצות",totalsField:"Teams",backgroundColor:"#B10DC9",click:"getAppliedTeamsBySport"},{caption:"שחקנים מאושרים",totalsField:"Players",backgroundColor:"#7FDBFF",click:"getAppliedPlayersBySport"},{caption:"קטגוריות אליפות",totalsField:"Championships",backgroundColor:"#FF851B",click:"getChampionshipsBySport"}]},{Items:[{caption:"בתי ספר",totalsField:"Schools",backgroundColor:"#2ECC40",click:"getAppliedTeamsBySchool"},{caption:"רשויות",totalsField:"Cities",backgroundColor:"#FF4136",click:"getAppliedTeamsByCities"},{caption:"משחקים",totalsField:"Matches",backgroundColor:"#0074D9",click:"getMatchesBySport"}]}]},{Type:13,Columns:[{Items:[{default:!1,caption:"רשויות שהגישו",totalsField:"Cities",backgroundColor:"#A5A5A5",click:"getTeamsByCity"},{caption:"מחוזות שהגישו",totalsField:"Regions",backgroundColor:"#ED7D31",click:"getTeamsByRegion"},{caption:"קבוצות שהוגשו",totalsField:"Teams",backgroundColor:"#5B9BD5",click:"getPeleAppliedTeamsBySport"},{caption:"ספורטאים/ות",totalsField:"Players",backgroundColor:"#ED7D31",click:"getApprovedPlayersBySport"}]},{Items:[{default:!1,caption:"רשויות עם קבוצות מאושרות",totalsField:"ApprovedCitiesCount",backgroundColor:"#A5A5A5",click:"getCitiesWithApprovedTeams"},{caption:"מחוזות עם קבוצות מאושרות",totalsField:"ApprovedRegionsCount",backgroundColor:"#ED7D31",click:"getRegionsWithApprovedTeams"},{caption:"קבוצות שאושרו",totalsField:"ApprovedTeams",backgroundColor:"#FFC000",click:"getPeleApprovedTeamsBySport"},{caption:'ספורטאים/ות פל"א',totalsField:"PelePlayers",backgroundColor:"#70AD47",click:"getPelePlayersBySport"}]}]},{Type:15,Columns:[{Items:[{default:!1,caption:"רשויות עם קבוצות",totalsField:"Cities",backgroundColor:"#ff4136",click:"getTeamsByCity"},{caption:"מחוזות עם קבוצות",totalsField:"Regions",backgroundColor:"#2ecc40",click:"getTeamsByRegion"}]},{Items:[{caption:"קבוצות שהוגשו",totalsField:"Teams",backgroundColor:"#b10dc9",click:"getPeleAppliedTeamsBySport"},{caption:"ספורטאים/ות",totalsField:"Players",backgroundColor:"#7fdbff",click:"getApprovedPlayersBySport"}]}]}],ActiveColumns:[]},sportsTotalsCaption:"הרשמת קבוצות לפי ענף",activePeleFunction:null}},props:{},computed:{highlightedDates:function(){var t=[];if(this.allEvents&&0<this.allEvents.length){var a=this.allEvents[0].date,s=a.getFullYear(),e=a.getMonth();t=n.distinctArray(this.allEvents.map(function(t){return t.date.getDate()})).map(function(t){return new Date(s,e,t)})}return{dates:t}}},mounted:function(){var e=this;e.reloadSports(),s.get(function(t,s){e.loggedUser=s,i.getSeasons().then(function(t){e.seasons=t,Vue.http.get("/api/v2/cache?key=season").then(function(t){var a=t.body.Value;null!=a?e.season=a:s.season&&(e.season=s.season),i.getRegions().then(function(t){e.regions=t;var a=null;s&&0===(a=s.coordinatedRegionId||s.region)&&(a=null),e.region=a,e.originalRegion=e.region,e.reloadCategories(),i.getGeneralData().then(function(t){e.contentSiteUrl=t.ContentSiteUrl||"/",i.getChampionships().then(function(t){e.championships=t,Vue.http.get("/api/v2/cache?key=dashboard-type").then(function(t){var a=t.body.Value;null!=a&&(e.type=a),e.getData()})})})})})})})},methods:{filterEvents:function(t,a){var e=this;void 0===a&&(a=!0);var s=t||new Date;a&&(this.date=s);var o={year:s.getFullYear(),month:s.getMonth()+1,region:this.region,sport:this.sport,championship:this.championship,type:this.type};if(function(t,a){return t.getFullYear()===a.getFullYear()&&t.getMonth()===a.getMonth()&&t.getDate()===a.getDate()}(new Date,s))e.calendarDayCaption="היום";else{var l=s.toISOString().slice(0,10).split("-"),r=[l[2],l[1],l[0]].join("/");e.calendarDayCaption="בתאריך "+r}i.getEvents(o).then(function(t){e.allEvents=t.map(function(t){return t.date=new Date(t.description),t.scoreLink=e.contentSiteUrl+"scores?season="+e.season+"&sport="+t.sportId+"&championship="+t.championshipId+"&category="+t.categoryId+"&selectedDate="+n.formatDate(t.date,"yyyy-mm-dd"),t}),e.events=e.allEvents.filter(function(t){return t.date.getDate()==e.date.getDate()});var s={};e.events.forEach(function(t){var a=t.categoryId.toString();s[a]?(s[a]++,t.toRemove=!0):s[a]=1}),e.events=e.events.filter(function(t){return!t.toRemove}),e.events.forEach(function(t){var a=s[t.categoryId.toString()];a&&1<a&&(t.title+=" ("+a+" משחקים)")})})},reloadSports:function(){var a=this;i.getSports(a.region).then(function(t){a.sports=t,a.originalSports=[],a.sports.forEach(function(t){a.originalSports.push(t)})})},reloadCategories:function(){var a=this;i.getCategoryNames(this.region,this.sport,this.season).then(function(t){a.categories=t})},refresh:function(t){var a=this;void 0!==t&&("type"===t?(this.sportsTotalsCaption="הרשמת קבוצות לפי ענף",this.activePeleFunction=null,Vue.http.post("/api/v2/cache",{key:"dashboard-type",value:a.type}),3!=a.type&&(a.region=a.originalRegion)):"season"!==t&&"region"!==t&&"sport"!==t&&"category"!==t||(null!=this.activePeleFunction&&this.activePeleFunction(),"category"!==t&&a.reloadCategories(),"season"===t&&Vue.http.post("/api/v2/cache",{key:"season",value:a.season}))),this.getData()},getData:function(){var n=this;3!==n.type&&5!==n.type||(n.originalRegion=n.region,n.region=0);var t={region:n.region,sport:n.sport,category:n.category,championship:n.championship,type:n.type,season:n.season};n.dataLoading=!0,n.filterEvents(),i.getDashboardData(t).then(function(t){1!=n.type&&t.Total&&(t.Total.Teams+=t.Total.RegistrationTeams||0,t.Total.Schools+=t.Total.RegistrationSchools||0,t.Total.Cities+=t.Total.RegistrationCities||0),t.TeamsBySportFields&&t.TeamsBySportFields.forEach(function(t){t.TeamsByStatus&&(t.TeamsByStatus.Registered+=t.TeamsByStatus.New||0)}),t.TeamsBySchools&&t.TeamsBySchools.forEach(function(t){t.TeamsByStatus&&(t.TeamsByStatus.Registered+=t.TeamsByStatus.New||0)}),t.TeamsByCities&&t.TeamsByCities.forEach(function(t){t.TeamsByStatus&&(t.TeamsByStatus.Registered+=t.TeamsByStatus.New||0)}),n.dashboardLatestData=t,10<=n.type&&null!=n.dashboardLatestData&&n.dashboardLatestData.SportFields?n.sports=n.dashboardLatestData.SportFields.map(function(t){return{id:t.Id,name:t.Name}}):null!=n.dashboardLatestData&&null!=n.dashboardLatestData.NonEmptySportFields&&(n.sports=n.dashboardLatestData.NonEmptySportFields.map(function(t){return{id:t.Id,name:t.Name}}),n.originalSports=[],n.sports.forEach(function(t){n.originalSports.push(t)})),n.footerData=t.FooterData||{},null==t.Payments&&(t.Payments={}),n.paymentsData.datasets[0].data[0]=t.Payments.PaidAmount,n.paymentsData.datasets[1].data[0]=t.Payments.TotalAmount-t.Payments.PaidAmount,n.paymentsData.datasets[0].data=n.paymentsData.datasets[0].data.slice(),n.paymentsData.datasets[1].data=n.paymentsData.datasets[1].data.slice(),n.paymentsData=Object.assign({},n.paymentsData),n.teamsData.datasets[0].data[0]=t.TeamsByGender.Boys,n.teamsData.datasets[0].data[1]=t.TeamsByGender.Girls,n.teamsData.datasets[0].data[2]=t.TeamsByGender.Unknown,n.teamsData.datasets[0].data=n.teamsData.datasets[0].data.slice(),n.teamsData=Object.assign({},n.teamsData),n.playersData.datasets[0].data[0]=t.PlayersByGender.Boys,n.playersData.datasets[0].data[1]=t.PlayersByGender.Girls,n.playersData.datasets[0].data[2]=t.PlayersByGender.Unknown,n.playersData.datasets[0].data=n.playersData.datasets[0].data.slice(),n.playersData=Object.assign({},n.playersData),t.Pele&&(n.peleData.datasets[0].data[0]=t.Pele.PlayersByGender.Boys,n.peleData.datasets[0].data[1]=t.Pele.PlayersByGender.Girls,n.peleData.datasets[0].data[2]=t.Pele.PlayersByGender.Unknown),n.peleData.datasets[0].data=n.peleData.datasets[0].data.slice(),n.peleData=Object.assign({},n.peleData),t.Pele&&(n.pelePercent=t.Pele.Percentage.toFixed(2));var a={};a=13==n.type||15==n.type?Object.assign(t.Total,{Regions:t.Pele.Total.Regions,Players:t.Pele.Total.Players,PelePlayers:t.Pele.Total.PelePlayers,Cities:t.Pele.Total.Cities,ApprovedTeams:t.Pele.Total.ApprovedTeams}):t.Total,n.totals=a;var s=n.totalDataColumns.Data.find(function(t){return t.Type==n.type});null==s&&(s=n.totalDataColumns.Data.find(function(t){return null==t.Type})),n.totalDataColumns.ActiveColumns=s.Columns;var e=null;if(null==n.lastSportTotalFilter)for(var o=0;o<n.totalDataColumns.ActiveColumns.length&&null==e;o++)for(var l=0;l<n.totalDataColumns.ActiveColumns[o].Items.length;l++){var r=n.totalDataColumns.ActiveColumns[o].Items[l];if(r.default){e=r;break}}null!=e?window.setTimeout(function(){n.dataColumnItemClick(e)},100):13!=n.type&&15!=n.type||null==n.activePeleFunction&&(n.sportsTotalsCaption="קבוצות לפי ענף",n.sportsTotals.datasets[0].label="קבוצות שהוגשו",n.sportsTotals.datasets[0].data=(n.dashboardLatestData.Pele.TeamsBySportFields||[]).map(function(t){return t.ApprovedTeams+t.NonApprovedTeams}),n.sportsTotals.datasets[1].label="קבוצות שאושרו",n.sportsTotals.datasets[1].data=(n.dashboardLatestData.Pele.TeamsBySportFields||[]).map(function(t){return t.ApprovedTeams}),n.verifySportsTotalsColors(),n.sportsTotals.labels=(n.dashboardLatestData.Pele.TeamsBySportFields||[]).map(function(t){return t.Name}),n.sportsTotals=Object.assign({},n.sportsTotals)),n.dataLoading=!1,!t.TeamsBySportFields&&0<n.sportsTotals.datasets[0].data.length||null!=n.lastSportTotalFilter&&n.lastSportTotalFilter()})},verifySportsTotalsColors:function(){for(var t=0;t<2;t++){var a=this.sportsTotals.datasets[t];if(null!=a.data&&a.data.length>a.backgroundColor.length){for(var s=[],e=0;e<a.backgroundColor.length;e++)s.push(a.backgroundColor[e]);for(;a.data.length>a.backgroundColor.length;)s.forEach(function(t){a.backgroundColor.push(t)})}}},dataColumnItemClick:function(t){t.click&&this[t.click]()},getViewParameters:function(){var t=this,a={competitionType:""};switch(3!=t.type&&null!=t.region&&(a.region=t.region),null!=t.sport&&(a.sport=t.sport),t.type){case 1:a.competitionType=1;break;case 2:case 3:a.competitionType=2}return a},updateParameters:function(t,a,s){var e={};for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);if(void 0!==a&&null!=a)if("string"==typeof a)void 0!==s&&(e[a]=s);else for(var o in a)a.hasOwnProperty(o)&&(e[o]=a[o]);return e},prepareBarChart:function(){var t=this;t.sportsTotals.datasets.splice(2),t.verifySportsTotalsColors(),t.sportsTotals.labels.length<=3&&t.sportsTotals.datasets.push(t.sportsTotals.singleSportDataSet),t.sportsTotals.views=null},getDataCounts:function(t){var a=" ("+this.sportsTotals.datasets[0].data[t]+")";return null!=this.sportsTotals.datasets[1].data&&(a+=" ("+this.sportsTotals.datasets[1].data[t]+")"),a},applySportData:function(t,a,s,e,o,l){var r=this;if(null!=r.dashboardLatestData){var n="",i=null;null!=r.sport?(t+=" לפי כיתות",i=r.dashboardLatestData[a+"ByCategories"],n="CategoryName",i.forEach(function(t){t.SportId=r.sport})):(t+=" לפי ענף",i=r.dashboardLatestData[a+"BySportFields"],n="SportName");var p=null==l?a+"Count":a+"ByStatus";if(r.sportsTotalsCaption=t,r.sportsTotals.datasets[0].label=o,r.sportsTotals.datasets[0].data=(i||[]).map(function(t){return null==l?t[p]:t[p].Confirmed}),null==l?r.sportsTotals.datasets[1].data=null:(r.sportsTotals.datasets[1].label=l,r.sportsTotals.datasets[1].data=(i||[]).map(function(t){return t[p].Registered})),r.sportsTotals.labels=(i||[]).map(function(t,a){return t[n]+r.getDataCounts(a)}),r.prepareBarChart(),s){var d=r.getViewParameters();r.sportsTotals.views=(i||[]).map(function(t){return{Link:s,Parameters:r.updateParameters(d,e,t.SportId)}})}else r.sportsTotals.views=null;r.sportsTotals=Object.assign({},r.sportsTotals)}},getAppliedTeamsBySport:function(){this.lastSportTotalFilter=this.getAppliedTeamsBySport,this.applySportData("הרשמת קבוצות","Teams","admin/teams","sport","מאושרות","רשומות")},getAppliedTeamsBySchool:function(){var t=this;t.lastSportTotalFilter=t.getAppliedTeamsBySchool,null!=t.dashboardLatestData&&(t.sportsTotalsCaption="הרשמת קבוצות לפי בית ספר",t.sportsTotals.datasets[0].label="מאושרות",t.sportsTotals.datasets[0].data=(t.dashboardLatestData.TeamsBySchools||[]).map(function(t){return t.TeamsByStatus.Confirmed}),t.sportsTotals.datasets[1].label="רשומות",t.sportsTotals.datasets[1].data=(t.dashboardLatestData.TeamsBySchools||[]).map(function(t){return t.TeamsByStatus.Registered}),t.sportsTotals.labels=(t.dashboardLatestData.TeamsBySchools||[]).map(function(t){return t.SchoolName}),t.prepareBarChart(),t.sportsTotals=Object.assign({},t.sportsTotals))},getAppliedTeamsByCities:function(){var t=this;t.lastSportTotalFilter=t.getAppliedTeamsByCities,null!=t.dashboardLatestData&&(t.sportsTotalsCaption="הרשמת קבוצות לפי רשות",t.sportsTotals.datasets[0].label="מאושרות",t.sportsTotals.datasets[0].data=(t.dashboardLatestData.TeamsByCities||[]).map(function(t){return t.TeamsByStatus.Confirmed}),t.sportsTotals.datasets[1].label="רשומות",t.sportsTotals.datasets[1].data=(t.dashboardLatestData.TeamsByCities||[]).map(function(t){return t.TeamsByStatus.Registered}),t.sportsTotals.labels=(t.dashboardLatestData.TeamsByCities||[]).map(function(t){return t.CityName}),t.prepareBarChart(),t.sportsTotals=Object.assign({},t.sportsTotals))},getAppliedPlayersBySport:function(){this.lastSportTotalFilter=this.getAppliedPlayersBySport,this.applySportData("הרשמת שחקנים","Players","admin/players","sport","מאושרים","רשומים")},getChampionshipsBySport:function(){this.lastSportTotalFilter=this.getChampionshipsBySport,this.applySportData("קטגוריות אליפות","Championships","admin/championships","competitionSport","קטגוריות אליפות",null)},getMatchesBySport:function(){this.lastSportTotalFilter=this.getMatchesBySport,this.applySportData("משחקים","Matches",null,null,"משחקים",null)},getPeleAppliedTeamsBySport:function(){var a=this;a.sportsTotalsCaption="קבוצות שהוגשו לפי ענף",a.activePeleFunction=a.getPeleAppliedTeamsBySport;var t={region:this.region,sport:this.sport,championship:this.championship,type:this.type,season:this.season};i.getPeleAppliedTeamsBySport(t).then(function(t){a.sportsTotals.datasets[0].data=t.Sports.map(function(t){return t.TeamCount}),a.sportsTotals.datasets[0].label="קבוצות",a.sportsTotals.datasets[1].data=null,a.sportsTotals.labels=t.Sports.map(function(t){return t.Sport}),a.sportsTotals.views=null,a.sportsTotals=Object.assign({},a.sportsTotals),e(a,t)})},getPeleApprovedTeamsBySport:function(){var a=this;a.sportsTotalsCaption="קבוצות שאושרו לפי ענף",a.activePeleFunction=a.getPeleApprovedTeamsBySport;var t={region:this.region,sport:this.sport,championship:this.championship,type:this.type,season:this.season};i.getPeleApprovedTeamsBySport(t).then(function(t){a.sportsTotals.datasets[0].data=t.Sports.map(function(t){return t.TeamCount}),a.sportsTotals.datasets[0].label="קבוצות",a.sportsTotals.datasets[1].data=null,a.sportsTotals.labels=t.Sports.map(function(t){return t.Sport}),a.sportsTotals.views=null,a.sportsTotals=Object.assign({},a.sportsTotals),e(a,t)})},getTeamsByRegion:function(){var a=this;a.sportsTotalsCaption="קבוצות לפי מחוז",a.activePeleFunction=a.getTeamsByRegion;var t={region:this.region,sport:this.sport,championship:this.championship,type:this.type,season:this.season};i.getTeamsByRegion(t).then(function(t){a.sportsTotals.datasets[0].data=t.map(function(t){return t.TeamCount}),a.sportsTotals.datasets[0].label="קבוצות",a.sportsTotals.datasets[1].data=null,a.sportsTotals.labels=t.map(function(t){return t.Region}),a.sportsTotals.views=null,a.sportsTotals=Object.assign({},a.sportsTotals)})},getTeamsByCity:function(){var a=this;a.sportsTotalsCaption="קבוצות לפי רשות",a.activePeleFunction=a.getTeamsByCity;var t={region:this.region,sport:this.sport,championship:this.championship,type:this.type,season:this.season};i.getTeamsByCity(t).then(function(t){a.sportsTotals.datasets[0].data=t.map(function(t){return t.TeamCount}),a.sportsTotals.datasets[0].label="קבוצות",a.sportsTotals.datasets[1].data=null,a.sportsTotals.labels=t.map(function(t){return t.City}),a.sportsTotals.views=null,a.sportsTotals=Object.assign({},a.sportsTotals)})},getCitiesWithApprovedTeams:function(){var t=this;t.sportsTotalsCaption="רשויות שהגישו קבוצות מאושרות",t.activePeleFunction=t.getCitiesWithApprovedTeams,t.sportsTotals.datasets[0].label="קבוצות שאושרו",t.sportsTotals.datasets[0].data=t.dashboardLatestData.Pele.Total.ApprovedCities.map(function(t){return t.ApprovedTeams}),t.sportsTotals.datasets[1].label="קבוצות שלא אושרו",t.sportsTotals.datasets[1].data=t.dashboardLatestData.Pele.Total.ApprovedCities.map(function(t){return t.NonApprovedTeams}),t.sportsTotals.labels=t.dashboardLatestData.Pele.Total.ApprovedCities.map(function(t){return t.Name}),t.sportsTotals.views=null,t.sportsTotals=Object.assign({},t.sportsTotals)},getRegionsWithApprovedTeams:function(){var t=this;t.sportsTotalsCaption="מחוזות שהגישו קבוצות מאושרות",t.activePeleFunction=t.getRegionsWithApprovedTeams,t.sportsTotals.datasets[0].label="קבוצות שאושרו",t.sportsTotals.datasets[0].data=t.dashboardLatestData.Pele.Total.ApprovedRegions.map(function(t){return t.ApprovedTeams}),t.sportsTotals.datasets[1].label="קבוצות שלא אושרו",t.sportsTotals.datasets[1].data=t.dashboardLatestData.Pele.Total.ApprovedRegions.map(function(t){return t.NonApprovedTeams}),t.sportsTotals.labels=t.dashboardLatestData.Pele.Total.ApprovedRegions.map(function(t){return t.Name}),t.sportsTotals.views=null,t.sportsTotals=Object.assign({},t.sportsTotals)},getApprovedPlayersBySport:function(){var a=this;a.sportsTotalsCaption="ספורטאים לפי ענף",a.activePeleFunction=a.getApprovedPlayersBySport;var t={region:this.region,sport:this.sport,championship:this.championship,type:this.type,season:this.season};i.getApprovedPlayersBySport(t).then(function(t){a.sportsTotals.datasets[0].data=t.map(function(t){return t.PlayerCount}),a.sportsTotals.datasets[0].label="ספורטאים/ות",a.sportsTotals.datasets[1].data=null,a.sportsTotals.labels=t.map(function(t){return t.Sport}),a.sportsTotals.views=null,a.sportsTotals=Object.assign({},a.sportsTotals)})},getPelePlayersBySport:function(){var a=this;a.sportsTotalsCaption='ספורטאי פל"א לפי ענף',a.activePeleFunction=a.getPelePlayersBySport;var t={region:this.region,sport:this.sport,championship:this.championship,type:this.type,season:this.season};i.getPelePlayersBySport(t).then(function(t){a.sportsTotals.datasets[0].data=t.map(function(t){return t.PlayerCount}),a.sportsTotals.datasets[0].label="ספורטאים",a.sportsTotals.datasets[1].data=null,a.sportsTotals.labels=t.map(function(t){return t.Sport}),a.sportsTotals.views=null,a.sportsTotals=Object.assign({},a.sportsTotals)})},openUnconfirmedDialog:function(t,a){var s=null;if(null!=this.dashboardLatestData&&null!=this.dashboardLatestData.FooterData&&(s=this.dashboardLatestData.FooterData.Token),null!=s){var e="/api/v2/manage/dashboard/unconfirmed-data?token="+s+"&entity="+t;o.open("generic/data-dialog",{caption:a,dataUrl:e},function(){})}else alert("נתוני לוח בקרה חסרים, נא לנסות שוב מאוחר יותר")}}})});